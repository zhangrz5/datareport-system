<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.company.datareport.mapper.UploadRecordMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.company.datareport.entity.UploadRecord">
        <id column="id" property="id" />
        <result column="task_id" property="taskId" />
        <result column="task_code" property="taskCode" />
        <result column="task_data_id" property="taskDataId" />
        <result column="batch_no" property="batchNo" />
        <result column="upload_type" property="uploadType" />
        <result column="upload_status" property="uploadStatus" />
        <result column="upload_data" property="uploadData" />
        <result column="request_url" property="requestUrl" />
        <result column="request_params" property="requestParams" />
        <result column="response_code" property="responseCode" />
        <result column="response_body" property="responseBody" />
        <result column="cost_time" property="costTime" />
        <result column="retry_count" property="retryCount" />
        <result column="error_msg" property="errorMsg" />
        <result column="remark" property="remark" />
        <result column="create_time" property="createTime" />
        <result column="update_time" property="updateTime" />
        <result column="create_by" property="createBy" />
        <result column="update_by" property="updateBy" />
        <result column="deleted" property="deleted" />
    </resultMap>

    <!-- 根据任务ID查询上报记录 -->
    <select id="selectByTaskId" resultMap="BaseResultMap">
        SELECT * FROM t_upload_record
        WHERE deleted = 0
        AND task_id = #{taskId}
        ORDER BY create_time DESC
    </select>

    <!-- 根据批次号查询上报记录 -->
    <select id="selectByBatchNo" resultMap="BaseResultMap">
        SELECT * FROM t_upload_record
        WHERE deleted = 0
        AND batch_no = #{batchNo}
        ORDER BY create_time DESC
    </select>

</mapper>
